A LOT of refactoring to do between disc_time and prepare
